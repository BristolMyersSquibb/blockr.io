% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write.R
\name{new_write_block}
\alias{new_write_block}
\title{Unified file writing block}
\usage{
new_write_block(
  directory = "",
  filename = "",
  format = "csv",
  mode = "browse",
  args = list(),
  ...
)
}
\arguments{
\item{directory}{Character. Default directory for file output (browse mode only).
Can be configured via \code{options(blockr.write_dir = "/path")} or environment
variable \code{BLOCKR_WRITE_DIR}. Default: current working directory.}

\item{filename}{Character. Optional fixed filename (without extension).
\itemize{
\item \strong{If provided}: Writes to same file path on every upstream change (auto-overwrite)
\item \strong{If empty} (default): Generates timestamped filename (e.g., \code{data_20250127_143022.csv})
}}

\item{format}{Character. Output format: "csv", "excel", "parquet", or "feather".
Default: "csv"}

\item{mode}{Character. Either "browse" to write files to server filesystem,
or "download" to trigger browser download. Default: "browse"}

\item{args}{Named list of format-specific writing parameters. Only specify values
that differ from defaults. Available parameters:
\itemize{
\item \strong{For CSV files:} \code{sep} (default: ","), \code{quote} (default: TRUE),
\code{na} (default: "")
\item \strong{For Excel/Arrow:} Minimal options needed (handled by underlying packages)
}}

\item{...}{Forwarded to \code{\link[blockr.core:new_transform_block]{blockr.core::new_transform_block()}}}
}
\value{
A blockr transform block that writes dataframes to files
}
\description{
A variadic block for writing dataframes to files in various formats.
Accepts multiple input dataframes and handles single files, multi-sheet
Excel, or ZIP archives depending on format and number of inputs.
}
\details{
\subsection{Variadic Inputs}{

This block accepts multiple dataframe inputs (1 or more) similar to \code{bind_rows_block}.
Inputs can be numbered ("1", "2", "3") or named ("sales_data", "inventory").
Input names are used for sheet names (Excel) or filenames (multi-file ZIP).
}

\subsection{File Output Behavior}{

\strong{Single input:}
\itemize{
\item Writes single file in specified format
\item Filename: \verb{\{filename\}.\{ext\}} or \verb{data_\{timestamp\}.\{ext\}}
}

\strong{Multiple inputs + Excel:}
\itemize{
\item Single Excel file with multiple sheets
\item Sheet names derived from input names
}

\strong{Multiple inputs + CSV/Arrow:}
\itemize{
\item Single ZIP file containing individual files
\item Each file named from input names
}
}

\subsection{Filename Behavior}{

\strong{Fixed filename} (\code{filename = "output"}):
\itemize{
\item Reproducible path: always writes to \verb{\{directory\}/output.\{ext\}}
\item Overwrites file on every upstream data change
\item Ideal for automated pipelines
}

\strong{Auto-timestamped} (\code{filename = ""}):
\itemize{
\item Unique files: \verb{\{directory\}/data_YYYYMMDD_HHMMSS.\{ext\}}
\item Preserves history, prevents accidental overwrites
\item Safe default behavior
}
}

\subsection{Mode: Browse vs Download}{

\strong{Browse mode:}
\itemize{
\item Writes files to server filesystem
\item User selects directory with file browser
\item Files persist on server
}

\strong{Download mode:}
\itemize{
\item Generates file and triggers browser download
\item File saved to user's download folder
\item Useful for exporting results
}
}
}
\examples{
\dontrun{
# Single dataframe to CSV
serve(new_write_block(
  directory = "/tmp",
  filename = "output",
  format = "csv"
))

# Multiple dataframes to Excel with auto-timestamp
serve(new_write_block(
  directory = "/tmp",
  filename = "",  # auto-generated
  format = "excel"
))

# CSV with custom delimiter
serve(new_write_block(
  directory = "/tmp",
  filename = "data",
  format = "csv",
  args = list(sep = ";")
))
}

}
